SPINE SORTER v5.54 - ARTIST GUIDE
========================================

WHAT DOES THIS TOOL DO?
----------------------------------------
This tool automates the process of preparing your Spine project images for the game engine. Instead of manually deciding which images should be JPEGs (for smaller file size) and which should be PNGs (for transparency), this tool scans your Spine project and sorts them for you automatically.

It ensures your project is optimized without breaking visual quality.

HOW TO USE IT
----------------------------------------
0. Click the "?" help button in the main window to open this manual from inside the app.
1. Open the tool.
2. Click "Browse" and select your folder containing .spine files.
3. Select the file you want to process from the list.
4. Click "Run Selected File".
5. Wait for the process to finish. A popup report will appear with options to review and save.

KEY FEATURES
----------------------------------------

1. SMART IMAGE SORTING
   The tool decides where each image goes based on how you used it in Spine:
   - JPEG Folder: Images that are fully opaque (no transparency) or used in special blend modes (like Additive) are moved here to save disk space.
   - PNG Folder: Images with transparent backgrounds or edges are kept here to ensure they look correct.
   - Images Folder: "Reference" images are kept separate.

2. INTELLIGENT WARNINGS (Pay attention to these!)
   The tool checks for common mistakes that break the game build:

   [ORANGE WARNING] "Unchecked for Export"
   - Problem: You are using an image in your animation, but you unchecked the "Export" box in the Spine hierarchy.
   - Result: This image will be missing in the game!
   - Fix: Go to Spine, find the image, and check the "Export" box.

   [RED WARNING] "Forced to PNG"
   - Problem: You put a file in a source "jpeg" folder, implying it should be opaque, but the tool detected transparent pixels (often invisible soft edges).
   - Result: The tool forced it to be a PNG to prevent white halos in the game.
   - Fix: If you really want it to be a JPEG, remove the alpha channel/transparency in Photoshop. Otherwise, the tool handled it for you.

   [MISSING FILES]
   - Problem: Spine thinks an image exists at a specific path, but it's not on your computer.
   - Fix: Check your path names or find the missing generic image.

   [UNCHECKED SKELETONS] [NEW]
   - Problem: Your project contains multiple skeletons (e.g., "Reference", "Main"), but one is unchecked for export.
   - Result: The entire skeleton file (.json) is missing from the output.
   - Fix: In Spine Export settings, ensure all required skeletons are selected.

   [UNCHECKED ANIMATIONS]
   - Problem: You created an animation in Spine, but accidentally unchecked "Export" for it.
   - Result: The animation will not play in the game.
   - Fix: The tool compares your active animations against the source file. If one is missing from the export data, it warns you.

   [HIDDEN / INVISIBLE SLOTS] [NEW]
   - Problem: A slot is set to "Hidden" (visible checkmark off) or "Invisible" (Alpha = 0) in the Setup Pose.
   - Result: This item may never appear in-game, even if you keyframe it to be visible later (depending on game engine logic).
   - Fix: Ensure all slots meant to be seen are visible and opaque in the Setup Pose.

3. THE REPORT CARD
   At the end of a run, you get a summary:
   - Total Attachments: How many distinct slots/attachments are in your Spine skeleton.
   - Exported Images: How many actual file paths were processed.
   - Animation Count: Validates that the number of animations in the source matches the export.
   - Copied counts: How many ended up as JPEGs vs PNGs.

4. SAFETY FEATURES

   - Validation: It checks if your .spine file is valid and can be opened.
   - Animation Integrity: Uses the official Spine CLI to verify the "Source of Truth" for your project structure.

5. CHECKBOX OPTIONS
----------------------------------------

The main interface has several checkboxes that control how the tool works.

[STANDARD OPTIONS]

- Check for Errors Only:
  If checked, the tool will SKIP the image sorting/conversion process. It will only run the validation logic (checking for missing files, unchecked animations, hidden slots, etc.) and generate a report. Use this for a quick health check.

- Open .spine after export:
  If checked, the tool will automatically launch the newly created .spine project file immediately after processing is complete.

- Sort all opaque images to jpeg:
  [IMPORTANT] This is the main optimization switch.
  - Checked (Default): Any image that has no transparency and is used in a "Normal" blend mode slot will be moved to the JPEG folder. This saves the most space.
  - Unchecked: Opaque images are kept as PNGs. Use this only if your game engine has trouble with JPEGs or if you see visual artifacts.
  Note: Images used in "Additive" or "Screen" blend modes are ALWAYS moved to JPEG, regardless of this setting, because they don't need transparency.

- Force local sorting (Old projects):
  - Use this for OLD, messy projects that haven't been organized yet.
  - If you are re-running the tool on a project you've already sorted before, keep this UNCHECKED.
  - If unchecked, the tool respects the existing folder structure.

[DEV OPTIONS]
(Click "Settings" -> "Dev options" to see these)

- Keep temporary files:
  Normally the tool creates a temporary folder during export and deletes it when done. Check this to keep that folder for debugging purposes.

- Pretty print JSON:
  Makes the output .json file human-readable with indentation. Useful if verify the data manually. Uncheck to make the file slightly smaller (minified).

- Export JSON only:
  Generates the data file but skips copying/converting images. Useful if you only changed attachment data but didn't add new images.

----------------------------------------
Tip: If you see a warning, fix it in Spine/Photoshop and run the tool again to verify!

========================================
HELP BUTTON
----------------------------------------
Click the `?` button next to the Settings button to open this user manual. The application will try to open the `USER_MANUAL.txt` file located next to the main script. If the manual cannot be found, the app will display the expected path so you can place a copy there.

========================================
NEW FEATURE SPOTLIGHT (SLIDE READY FORMAT)
Copy the sections below for your presentation
========================================

[SLIDE 1: THE PROBLEM]
Title: Hidden Export Accidents
Body:
*   In Spine, every animation has a small "Export" checkbox.
*   It is very easy to accidentally uncheck this while working.
*   The Result: The animation exists in your project, but is silently deleted from the game data.
*   The Risk: You won't notice until the game is built and the character "freezes".

[SLIDE 2: THE SOLUTION]
Title: Automated Integrity Check
Body:
*   The Spine Sorter now acts as a "Source of Truth" verifier.
*   Step 1: It asks the Spine Editor directly: "List every animation that exists in this file."
*   Step 2: It reads the final exported data file.
*   Step 3: It compares the two lists instantly.

[SLIDE 3: HOW IT WORKS]
Title: Smart Detection Logic
Body:
*   Ignores "noise": Filters out duplicate names and output clutter.
*   Supports all versions: Works with Spine 3.8, 4.0, 4.1, 4.2+.
*   Deep Scan: Checks multiple skeletons (e.g., "Reference" vs "Main") in a single pass.
*   Legacy Support: Reads both modern comma-separated formats and older indented formats.

[SLIDE 4: THE RESULT]
Title: Artist Peace of Mind
Body:
*   Pass: "Animation Count: 18/18 (100%)"
*   Fail: "WARNING: Found 20 animations in source, but only 19 in export!"
*   Action: The tool names exactly which animation is missing, so you can fix it in seconds.


========================================
CHANGELOG (v5.0 - v5.54)
========================================

v5.54 (Released)
*   NEW: Added duplicate-image detection (SHA1 grouping) and reporting as RECOMMENDATIONS.
*   NEW: Added naming-convention checks with fuzzy spell-check for common animation/skeleton tokens (flags probable misspellings like "anticipation").
*   CHANGE: Skeleton and Animation name problems are now shown as WARNINGS (red) in the UI and included in the Warnings section of the plain-text report.
*   CHANGE: "Check for Errors Only" defaults to OFF in-memory; validate-only runs now delete temporary export folders unless "Keep temporary files" is checked.
*   FIX: Prevented output package name being overwritten by local slot/attachment variable (renamed local variable to `slot_name`).
*   NOTE: Temporary JSON is now scanned for naming issues before deletion so binary `.spine` inputs also get naming/warning coverage when the JSON is produced.

v5.53 (Previous)
*   NEW: Added check for "Hidden" slots (visible: false) in Setup Pose.
*   NEW: Added check for "Invisible" slots (Alpha=0) in Setup Pose.
*   NEW: "Check for Errors Only" mode moved to main settings for easier access.
*   NEW: Reports now open in a Popup Dialog with a "Save As" option (no longer auto-saves .txt files).
*   FIX: Improved CLI parsing to ignore "Skeleton" and "Size" headers in Spine logs.

v5.52
*   NEW: Added "Unchecked Animations" detection.
*   NEW: Added support for checking multiple skeletons in one project.
*   FIX: Enhanced CLI integration reliability.

v5.51
*   NEW: "Validate Only" mode introduced (Dev Options).
*   FIX: Better handling of Soft Edges in JPEG/PNG sorting.

v5.0
*   Major Release: Smart Image Sorting (Auto-detecting Transparency).
*   NEW: CLI-based "Source of Truth" verification.
*   NEW: JSON Minification options.


